# perf2

## System Configuration

* Sockets: 2
* CPU: Intel Xeon Gold 5418Y CPU / 24 cores per socket / 48 cores total / SMT-enabled
* Memory: 256 GB / DDR5 / 4800 MT/s

## Intel AMX Performance Benchmark

### 2D Tile Registers

The 8 2D tile registers are each 1KiB in size. These registers 
have 16 rows each of 64 bytes. For BF16 this means, a matrix of 16 * 32 BF16 numbers 
whereas for INT8, this means a matrix of 16 * 64 INT8 numbers.

### Configuration

1. TMUL: 48 (1 per core)
2. Tiles: 48 * 8 * 1KiB = 384 KiB (1 per TMUL)

### Results

```bash
-------------------------------------------------------------------------------------------
|   Mode   |    N1 / N2 / M    | Data size (MiB) | Total FLOP  | Duration (us) | GFLOPS   |
-------------------------------------------------------------------------------------------
| IP / AMX | 64/64/64          |        0.016384 |     520192  |         27801 | 0.018711 |
| IP / AMX | 128/128/128       |        0.065536 | 4.17792e+06 |         21064 | 0.198344 |
| IP / AMX | 256/256/256       |        0.262144 | 3.34889e+07 |         31293 | 1.07017  |
| IP / AMX | 512/512/512       |         1.04858 | 2.68173e+08 |         14394 | 18.6309  |
| IP / AMX | 1024/1024/1024    |          4.1943 | 2.14644e+09 |         16274 | 131.894  |
| IP / AMX | 2048/2048/2048    |         16.7772 | 1.71757e+10 |         17229 | 996.905  |
| IP / AMX | 4096/4096/4096    |         67.1089 | 1.37422e+11 |         51927 | 2646.45  |
| IP / AMX | 8192/8192/8192    |         268.435 | 1.09944e+12 |         89398 | 12298.3  |
| IP / AMX | 16384/16384/16384 |         1073.74 | 8.79582e+12 |        528672 | 16637.6  |
| IP / AMX | 32768/32768/32768 |         4294.97 | 7.03677e+13 |   3.71095e+06 | 18962.2  |
-------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
|    Mode    |    N1 / N2 / M    | Data size (MiB) | Total FLOP | Duration (us) | GFLOPS     |
----------------------------------------------------------------------------------------------
| GEMM / AMX | 64/64/64          |        0.016384 |     520192  |          6908 | 0.0753028 |
| GEMM / AMX | 128/128/128       |        0.065536 | 4.17792e+06 |          7210 | 0.579462  |
| GEMM / AMX | 256/256/256       |        0.262144 | 3.34889e+07 |           499 | 67.112    |
| GEMM / AMX | 512/512/512       |         1.04858 | 2.68173e+08 |          1639 | 163.62    |
| GEMM / AMX | 1024/1024/1024    |          4.1943 | 2.14644e+09 |          5108 | 420.21    |
| GEMM / AMX | 2048/2048/2048    |         16.7772 | 1.71757e+10 |          9005 | 1907.35   |
| GEMM / AMX | 4096/4096/4096    |         67.1089 | 1.37422e+11 |         14439 | 9517.43   |
| GEMM / AMX | 8192/8192/8192    |         268.435 | 1.09944e+12 |        124502 | 8830.74   |
| GEMM / AMX | 16384/16384/16384 |         1073.74 | 8.79582e+12 |   1.24479e+06 | 7066.12   |
| GEMM / AMX | 32768/32768/32768 |         4294.97 | 7.03677e+13 |   2.52628e+06 | 27854.2   |
----------------------------------------------------------------------------------------------
```
